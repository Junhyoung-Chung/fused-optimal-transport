\documentclass{article}

% if you need to pass options to natbib, use, e.g.:
%     \PassOptionsToPackage{numbers, compress}{natbib}
% before loading neurips_2025

% The authors should use one of these tracks.
% Before accepting by the NeurIPS conference, select one of the options below.
% 0. "default" for submission
% \usepackage{neurips_2025}
% the "default" option is equal to the "main" option, which is used for the Main Track with double-blind reviewing.
% 1. "main" option is used for the Main Track
%  \usepackage[main]{neurips_2025}
% 2. "position" option is used for the Position Paper Track
%  \usepackage[position]{neurips_2025}
% 3. "dandb" option is used for the Datasets & Benchmarks Track
 % \usepackage[dandb]{neurips_2025}
% 4. "creativeai" option is used for the Creative AI Track
%  \usepackage[creativeai]{neurips_2025}
% 5. "sglblindworkshop" option is used for the Workshop with single-blind reviewing
 % \usepackage[sglblindworkshop]{neurips_2025}
% 6. "dblblindworkshop" option is used for the Workshop with double-blind reviewing
%  \usepackage[dblblindworkshop]{neurips_2025}

% After being accepted, the authors should add "final" behind the track to compile a camera-ready version.
% 1. Main Track
\usepackage[main, final]{neurips_2025}
% 2. Position Paper Track
%  \usepackage[position, final]{neurips_2025}
% 3. Datasets & Benchmarks Track
 % \usepackage[dandb, final]{neurips_2025}
% 4. Creative AI Track
%  \usepackage[creativeai, final]{neurips_2025}
% 5. Workshop with single-blind reviewing
%  \usepackage[sglblindworkshop, final]{neurips_2025}
% 6. Workshop with double-blind reviewing
%  \usepackage[dblblindworkshop, final]{neurips_2025}
% Note. For the workshop paper template, both \title{} and \workshoptitle{} are required, with the former indicating the paper title shown in the title and the latter indicating the workshop title displayed in the footnote.
% For workshops (5., 6.), the authors should add the name of the workshop, "\workshoptitle" command is used to set the workshop title.
% \workshoptitle{WORKSHOP TITLE}

% "preprint" option is used for arXiv or other preprint submissions
 % \usepackage[preprint]{neurips_2025}

% to avoid loading the natbib package, add option nonatbib:
%    \usepackage[nonatbib]{neurips_2025}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor}         % colors
\usepackage{mathtools}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{cleveref}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma} 
\newtheorem{proposition}{Proposition} 
\newtheorem{corollary}{Corollary}
\newtheorem{definition}{Definition} 
\newtheorem{example}{Example} 
\newtheorem{assumption}{Assumption}
\newtheorem{claim}{Claim}
\newtheorem{remark}{Remark}
\newtheorem{note}{Note} 
\newtheorem{question}{Question}

\crefname{theorem}{Theorem}{Theorems}
\Crefname{theorem}{Theorem}{Theorems}

\crefname{lemma}{Lemma}{Lemmas}
\Crefname{lemma}{Lemma}{Lemmas}

\crefname{proposition}{Proposition}{Propositions}
\Crefname{proposition}{Proposition}{Propositions}

\crefname{corollary}{Corollary}{Corollaries}
\Crefname{corollary}{Corollary}{Corollaries}

\crefname{definition}{Definition}{Definitions}
\Crefname{definition}{Definition}{Definitions}

\crefname{example}{Example}{Examples}
\Crefname{example}{Example}{Examples}

\crefname{assumption}{Assumption}{Assumptions}
\Crefname{assumption}{Assumption}{Assumptions}

\crefname{claim}{Claim}{Claims}
\Crefname{claim}{Claim}{Claims}

\crefname{remark}{Remark}{Remarks}
\Crefname{remark}{Remark}{Remarks}

\crefname{note}{Note}{Notes}
\Crefname{note}{Note}{Notes}

\crefname{question}{Question}{Questions}
\Crefname{question}{Question}{Questions}

\DeclareMathOperator*{\argmin}{arg\,min}

% Note. For the workshop paper template, both \title{} and \workshoptitle{} are required, with the former indicating the paper title shown in the title and the latter indicating the workshop title displayed in the footnote. 
\title{Fused Optimal Transport Plan}


% The \author macro works with any number of authors. There are two commands
% used to separate the names and addresses of multiple authors: \And and \AND.
%
% Using \And between authors leaves it to LaTeX to determine where to break the
% lines. Using \AND forces a line break at that point. So, if LaTeX puts 3 of 4
% authors names on the first line, and the last on the second line, try using
% \AND instead of \And before the third author name.


\author{%
  Junhyoung Chung\thanks{\href{https://junhyoung-chung.github.io/}{https://junhyoung-chung.github.io/}} \\
  Department of Statistics\\
  Seoul National University\\
  Seoul 08826, Republic of Korea \\
  \texttt{junhyoung0534@gmail.com} \\
  % examples of more authors
  % \And
  % Coauthor \\
  % Affiliation \\
  % Address \\
  % \texttt{email} \\
  % \AND
  % Coauthor \\
  % Affiliation \\
  % Address \\
  % \texttt{email} \\
  % \And
  % Coauthor \\
  % Affiliation \\
  % Address \\
  % \texttt{email} \\
  % \And
  % Coauthor \\
  % Affiliation \\
  % Address \\
  % \texttt{email} \\
}


\begin{document}


\maketitle


\begin{abstract}
  The abstract paragraph should be indented \nicefrac{1}{2}~inch (3~picas) on
  both the left- and right-hand margins. Use 10~point type, with a vertical
  spacing (leading) of 11~points.  The word \textbf{Abstract} must be centered,
  bold, and in point size 12. Two line spaces precede the abstract. The abstract
  must be limited to one paragraph.
\end{abstract}


\section{Introduction}

\section{Fused Optimal Transport Plan}

\paragraph{Notations.}
Let $(\Omega,\mathcal{F},\mathbb{P})$ be a probability space and $(S,d_S)$ a compact metric space. 
A measurable map $X:\Omega\to S$ is called a random element with distribution $\mathbb{P}_X\coloneqq\mathbb{P}\circ X^{-1}$.
We also introduce a feature space $M\subset\mathbb{R}^d$ which is compact, and call any one-to-one and continuous $f:S\to M$ a feature function. Throughout this study, we assume that $\mathrm{diam}(S) = \mathrm{diam}(M) = 1$, where $\mathrm{diam}(A) \coloneqq \sup_{x,x^\prime \in A}d_A(x,x^\prime)$. For two probability measures $\mu,\nu$ on $S$, denote by
\begin{align*}
\Pi(\mu,\nu)\;=\;\{\pi\ \text{on }S\times S:\ \text{the marginals are }\mu\text{ and }\nu\}
\end{align*}
the set of all couplings between $\mu$ and $\nu$. Lastly, we say a measurable map $T: S \to S$ pushes forward $\mu$ to $\nu$ if $\mu(T^{-1}(A)) = \nu(A)$ for all $A \in \mathcal{B}(S)$, where $\mathcal{B}(S)$ is the Borel $\sigma$-algebra of $S$. We denote $T_{\#}\mu = \nu$ if $T$ pushes forward $\mu$ to $\nu$.

\paragraph{Fused optimal transport plan.}
For $0\le \alpha\le 1$ and a feature function $f$, we consider
\begin{align}
	\label{eq:pi-fused-ot}
	\inf_{\pi\in\Pi(\mathbb{P}_X,\mathbb{P}_Y)} 
	(1-\alpha)&\mathbb{E}_{(X,Y)\sim\pi}\big[\|f(X)-f(Y)\|_2^2\big] \nonumber\\
	&+ \alpha\mathbb{E}_{\substack{(X,Y)\sim\pi\\(X^\prime,Y^\prime)\sim\pi}}
	\Big[K_h(X,X^\prime) \big|d_S(X,X^\prime)-d_S(Y,Y^\prime)\big|^2\Big],
\end{align}
where $K_h:S\times S\to[0,\infty)$ is a bounded, continuous, and symmetric kernel with a bandwidth $h > 0$. We write $\mathcal{S}_{\alpha,h}$ for the set of minimizers of \eqref{eq:pi-fused-ot}.

\begin{proposition}[Existence of a minimizer]
	\label{prop:existence}
	For each $0\le \alpha\le 1$ and $h > 0$, the problem \eqref{eq:pi-fused-ot} admits at least one minimizer; that is, $\mathcal{S}_{\alpha,h}\neq\emptyset$.
\end{proposition}

%\begin{proof}[Proof sketch]
%	Since $S$ is compact, $\Pi(\mathbb{P}_X,\mathbb{P}_Y)$ is tight and compact in the weak topology. 
%	Both terms in \eqref{eq:pi-fused-ot} are expectations of bounded continuous functions of $(X,Y)$ (and $(X',Y')$) when $f$, $d_S$, and $K_h$ are continuous, hence the objective is weakly lower semicontinuous in $\pi$. 
%	Therefore a minimizer exists.
%\end{proof}

%\paragraph{An equivalent formulation in feature space.}
%Let $Z\coloneqq f(X)$ and $W \coloneqq f(Y)$, and consider the set of couplings $\Pi(\mathbb{P}_Z,\mathbb{P}_W)$ on $M\times M$. 
%Define $K_h^g(z,z')\coloneqq K_h(g(z),g(z'))$ with $g \coloneqq f^{-1}$ on $f(S)$. 
%Then, \eqref{eq:pi-fused-ot} is equivalent to
%\begin{align}
%	\label{eq:gamma-fused-ot}
%	\inf_{\gamma\in\Pi(\mathbb{P}_Z,\mathbb{P}_W)}\ 
%	(1-\alpha)&\mathbb{E}_{(Z,W)\sim\gamma}\big[\|Z-W\|_2^2\big] \nonumber\\
%	&+ \alpha\mathbb{E}_{\substack{(Z,W)\sim\gamma\\(Z',W')\sim\gamma}}
%	\!\Big[K_h^g(Z,Z')\big|d_S\big(g(Z),g(Z')\big)-d_S\big(g(W),g(W')\big)\big|^2\Big].
%\end{align}
%Thus, $\pi$ is feasible for \eqref{eq:pi-fused-ot} if and only if $\gamma=(f\times f)_\#\pi$ is feasible for \eqref{eq:gamma-fused-ot} with the same objective value. Let $\mathcal{S}^f_\alpha$ be the solution set for \eqref{eq:gamma-fused-ot}, which is in fact $\mathcal{S}^f_{\alpha,h} = \{(f \times f)_{\#}\pi : \;\pi \in \mathcal{S}_{\alpha,h}\}$. In the sequel, we focus on analyzing \eqref{eq:gamma-fused-ot} for mathematical simplicity.

\section{Local Geometric Preserving Optimal Transport}

This section discusses another method to learn an optimal transport while preserving local geometry, which actually coincides with \eqref{eq:pi-fused-ot} as $h \to 0$. We will investigate this later. We first state some technical assumptions.
\begin{assumption}
	\label{ass:kernel-analysis}
	We assume the followings:
	\begin{itemize}
		\item[(A1)] $S$ is an $m$-dimensional compact Riemannian manifold.
		\item[(A2)] The density of $X$, denoted by $p_X$, is twice-differentiable ($p_X \in \mathcal{C}^2$) and $c \leq p_X \leq C$ for some constants $c,C > 0$.
		\item[(A3)] $S$ and $M$ are $\mathcal{C}^2$-diffeomorphic, and $f$ is a $\mathcal{C}^2$-diffeomorphism.
		\item[(A4)] $K_h(x,x^\prime) = h^{-(m+2)}\kappa(d_S(x,x^\prime)/h)$ for some $\kappa : [0,\infty) \to [0,\infty)$, where $\kappa$ is (i) continuous, (ii) bounded, (iii) non-increasing, (iv) compactly supported, and (v) $\int_{\mathbb{R}^m} \kappa(\|u\|) du = 1$.
	\end{itemize}
\end{assumption}

Now, consider the following problem:
\begin{align}
	\label{eq:LGP-ot}
	\min_{T \in \mathcal{C}^1: T_{\#}\mathbb{P}_X = \mathbb{P}_Y} (1-\alpha)\mathbb{E}_{X \sim \mathbb{P}_X}\big[\|f(X)-f(T(X))\|_2^2\big] + \alpha\int_{S} \|(\mathcal{J}T)^\top(\mathcal{J}T) - I\|_F^2  .
\end{align}

\begin{theorem}
	For $h > 0$, let $R^\pi(h)$ be defined as
	\begin{align*}
		R^\pi(h) \coloneqq \mathbb{E}_{\substack{(X,Y)\sim\pi\\(X',Y')\sim\pi}} \Big[K_h(X,X') \big|d_S(X,X')-d_S(Y,Y')\big|^2\Big] .
	\end{align*}
	Under \cref{ass:kernel-analysis}, $R^\pi(h)$ converges to a limit $R^\pi(0)$ as $h \to 0$. In particular,
	\begin{align*}
		R^\pi(0) = ??
	\end{align*}
\end{theorem}




%%% References %%%
\bibliographystyle{abbrvnat}
\bibliography{FOT_references}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%          %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Appendix %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%          %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\appendix
\section{Appendix}

%\subsection{Proof for \cref{lem:brenier}}
%
%\begin{proof}
%	Since $\alpha = 0$, \eqref{eq:T-fused-optimal-transport} boils down to the following optimization problem:
%	\begin{align}
%		\label{eq:T-ot}
%		\min_{T: T_{\#}\mathbb{P}_X = \mathbb{P}_Y} \mathbb{E}\Big[\|f(X) - f(T(X))\|_2^2\Big] .
%	\end{align}
%	Define $Z \coloneqq f(X)$, whose distribution $\mathbb{P}_Z$ is equal to $f_{\#}\mathbb{P}_X$. In addition, by \cref{ass:feature-function}, we can define $g \coloneqq f^{-1}$, where $f^{-1}$ is defined on $f(S)$. Then, the above problem is equivalent to
%	\begin{align}
%		\label{eq:U-ot}
%		%\min_{T: T_{\#}\mathbb{P}_X = \mathbb{P}_Y} \mathbb{E}\Big[\|Z - (f \circ T \circ g)(Z)\|_2^2\Big] = \min_{U: U_{\#}\mathbb{P}_Z = f_{\#}\mathbb{P}_Y} \mathbb{E}\Big[\|Z - U(Z)\|_2^2\Big] .
%		\min_{U: U_{\#}\mathbb{P}_Z = f_{\#}\mathbb{P}_Y} \mathbb{E}\Big[\|Z - U(Z)\|_2^2\Big] .
%	\end{align}
%	This is because $(f \circ T \circ g)_{\#}\mathbb{P}_Z = f_{\#}\mathbb{P}_Y$ when $T_{\#}\mathbb{P}_X = \mathbb{P}_Y$. Now, the Brenier theorem guarantees that under \cref{ass:absolute-continuity,ass:finite-second-moment}, there exists a $\mathbb{P}_Z$-a.e. unique solution $U^\ast$ for \eqref{eq:U-ot}.
%	
%	Let $T^\ast \coloneqq g \circ U^\ast \circ f$. Observe that $T^\ast_{\#}\mathbb{P}_X = g_{\#}(U^\ast_{\#}\mathbb{P}_Z) = \mathbb{P}_Y$ and that $f(T^\ast(X)) = U^\ast(Z)$, which implies that $T^\ast$ is a solution for \eqref{eq:T-ot}.
%	
%	What remains is to show that $T^\ast$ is $\mathbb{P}_X$-a.e. unique. Suppose that there exists another solution $\tilde{T}^\ast$ such that $\mathbb{P}(T^\ast(X) \neq \tilde{T}^\ast(X)) > 0$. Then,
%	\begin{align*}
%		\mathbb{P}(T^\ast(X) \neq \tilde{T}^\ast(X)) = \mathbb{P}(g(U^\ast(Z)) \neq (\tilde{T}^\ast \circ g)(Z)) = \mathbb{P}(U^\ast(Z) \neq (f \circ \tilde{T}^\ast \circ g)(Z)) > 0 .
%	\end{align*}
%	Considering that $\tilde{U}^\ast \coloneqq f \circ \tilde{T}^\ast \circ g$ is also a solution for \eqref{eq:U-ot}, this contradicts to the fact that $U^\ast$ is $\mathbb{P}_Z$-a.e. unique.
%\end{proof}

\end{document}